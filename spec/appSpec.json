{
  "app": {
    "name": "SOSG Running Club Hub",
    "platform": "mobile_web_pwa",
    "design": {
      "layout": "mobile_first",
      "navigation": "bottom_tabs",
      "tone": "warm_supportive_coaching",
      "privacyDefault": "strict"
    },
    "roles": ["CAREGIVER", "COACH", "ADMIN"]
  },
  "state": {
    "role": "COACH",
    "authed": false,
    "athleteListSearch": "",
    "athleteListSort": "Active",
    "athleteListPage": 1,
    "athleteListPages": 2,
    "athleteListTotal": 32,
    "athleteListPageSize": 20,
    "currentDetailTab": "feed",
    "timelineFilter": "all",
    "uiState": {
      "activeModal": null,
      "cuesSidebarExpanded": true,
      "selectedActivityId": null
    },
    "strava": {
      "accessTokenPresent": false,
      "lastImportAt": null,
      "hashtag": "#sosg",
      "autoImportEnabled": true,
      "importRules": {
        "mode": "TAG",
        "timeWindowMinutes": 240
      }
    }
  },
  "routes": {
    "initial": "login",
    "tabs": [
      { "id": "tab_athletes", "label": "Athletes", "icon": "üë•", "route": "athlete_list" },
      { "id": "tab_profile", "label": "Profile", "icon": "‚öôÔ∏è", "route": "profile" }
    ]
  },
  "screens": [
    {
      "id": "login",
      "title": "SOSG Running Club",
      "route": "login",
      "layout": { "type": "centered" },
      "components": [
        { "type": "textInput", "id": "email", "props": { "label": "Email", "placeholder": "name@example.com" } },
        { "type": "passwordInput", "id": "password", "props": { "label": "Password" } },
        {
          "type": "select",
          "id": "role_selector",
          "props": { "label": "Role", "options": ["CAREGIVER", "COACH", "ADMIN"], "default": "COACH" },
          "actions": [{ "type": "setState", "path": "state.role", "value": "{{value}}" }]
        },
        {
          "type": "button",
          "id": "btn_login",
          "props": { "label": "Login" },
          "actions": [
            { "type": "setState", "path": "state.authed", "value": true },
            { "type": "navigate", "to": "athlete_list" }
          ]
        },
        {
          "type": "link",
          "id": "link_register",
          "props": { "text": "Don't have an account? Register" },
          "actions": [{ "type": "navigate", "to": "register" }]
        }
      ]
    },

    {
      "id": "athlete_list",
      "title": "Athletes",
      "route": "athlete_list",
      "layout": { "type": "list" },
      "components": [
        { "type": "searchBar", "id": "athlete_search", "props": { "placeholder": "Search athletes...", "autoFocus": true } },
        {
          "type": "segmentedControl",
          "id": "athlete_sort",
          "props": { 
            "options": ["Name", "Active"],
            "default": "Active",
            "stateBinding": "state.athleteListSort"
          },
          "actions": [
            { "type": "setState", "path": "state.athleteListSort", "value": "{{value}}" }
          ]
        },
        {
          "type": "list",
          "id": "athlete_cards",
          "props": { "itemTemplate": "athleteCard", "className": "athlete-list" },
          "dataBinding": "mockData.filteredAthletes",
          "emptyState": { "title": "No athletes found", "message": "Try adjusting your search or filters" },
          "actions": [{ "type": "navigate", "to": "athlete_detail", "with": { "athleteId": "{{item.id}}" } }]
        },
        {
          "type": "text",
          "id": "athletes_count",
          "props": { "text": "Showing {{mockData.filteredAthletes.length}} athlete(s)" },
          "dataBinding": "mockData.filteredAthletes"
        },
        {
          "type": "div",
          "id": "pagination_controls",
          "props": { "className": "pagination-controls" },
          "components": [
            { "type": "text", "props": { "text": "Page {{state.athleteListPage}} of {{state.athleteListPages}}", "className": "pagination-text" } },
            { "type": "div", "props": { "className": "pagination-buttons" }, "components": [
              {
                "type": "button",
                "id": "btn_prev_page",
                "props": { "label": "‚Üê Previous" },
                "actions": [{ "type": "setState", "path": "state.athleteListPage", "value": "{{state.athleteListPage - 1}}" }]
              },
              {
                "type": "button",
                "id": "btn_next_page",
                "props": { "label": "Next ‚Üí" },
                "actions": [{ "type": "setState", "path": "state.athleteListPage", "value": "{{state.athleteListPage + 1}}" }]
              }
            ]}
          ]
        }
      ]
    },

    {
      "id": "athlete_detail",
      "title": "Athlete Hub",
      "route": "athlete_detail/:athleteId",
      "layout": { "type": "stack" },
      "onEnter": [
        { "type": "selectAthleteByRouteParam", "param": "athleteId", "from": "mockData.athletesFull", "target": "mockData.selectedAthlete" },
        { "type": "setState", "path": "state.uiState.activeModal", "value": null },
        { "type": "setState", "path": "state.currentDetailTab", "value": "feed" },
        { "type": "autoSyncStrava" }
      ],
      "components": [
        {
          "type": "header",
          "id": "hdr_athlete",
          "props": {
            "leftAction": { "type": "navigate", "to": "athlete_list" },
            "titleBinding": "mockData.selectedAthlete.name",
            "rightIcon": "‚öôÔ∏è"
          },
          "actions": [{ "type": "setState", "path": "state.currentDetailTab", "value": "settings" }]
        },

        {
          "type": "card",
          "id": "card_athlete_stats",
          "props": { "title": "Overview", "className": "card-stats" },
          "components": [
            {
              "type": "kvList",
              "id": "stats_list",
              "props": {
                "items": [
                  { "k": "Sessions", "v": "{{mockData.selectedAthlete.sessionCount}}", "icon": "üèÉ", "className": "stat-row" },
                  { "k": "Last activity", "v": "{{mockData.selectedAthlete.lastActivityFormatted}}", "icon": "üìÖ", "className": "stat-row" },
                  { "k": "Status", "v": "{{mockData.selectedAthlete.status}}", "icon": "‚úì", "className": "stat-row" }
                ]
              }
            }
          ]
        },

        {
          "type": "segmentedControl",
          "id": "detail_tabs",
          "props": {
            "options": [
              { "label": "Feed", "value": "feed" },
              { "label": "Cues", "value": "cues" },
              { "label": "Settings", "value": "settings" }
            ],
            "default": "feed",
            "stateBinding": "state.currentDetailTab",
            "isTabs": true
          },
          "actions": [
            { "type": "setState", "path": "state.currentDetailTab", "value": "{{value}}" }
          ]
        },

        {
          "type": "conditionalRender",
          "id": "tab_feed",
          "condition": "{{state.currentDetailTab === 'feed'}}",
          "components": [
            {
              "type": "segmentedControl",
              "id": "timeline_filter",
              "props": {
                "options": [
                  { "label": "All", "value": "all" },
                  { "label": "Sessions", "value": "session" },
                  { "label": "Notes", "value": "note" }
                ],
                "default": "all",
                "stateBinding": "state.timelineFilter",
                "isTabs": true
              },
              "actions": [
                { "type": "setState", "path": "state.timelineFilter", "value": "{{value}}" }
              ]
            },

            {
              "type": "list",
              "id": "timeline_feed",
              "props": { "itemTemplate": "timelineCard", "className": "feed-container" },
              "dataBinding": "mockData.selectedAthlete.timeline",
              "filterBinding": { "controlId": "timeline_filter", "map": { "all": "*", "session": "session", "note": "note", "milestone": "milestone" } },
              "emptyState": { "title": "No activities yet", "message": "Add a session or enable Strava to start the athlete's journey." },
              "actions": [
                { "type": "setState", "path": "state.uiState.selectedActivityId", "value": "{{item.id}}" },
                { "type": "setState", "path": "state.uiState.activeModal", "value": "addNote" }
              ]
            },

            {
              "type": "actionBar",
              "id": "feed_actions",
              "props": { "style": "sticky_bottom" },
              "components": [
                {
                  "type": "button",
                  "id": "btn_add_session",
                  "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
                  "props": { "label": "Add Session" },
                  "actions": [{ "type": "setState", "path": "state.uiState.activeModal", "value": "addSession" }]
                },
                {
                  "type": "button",
                  "id": "btn_import_strava",
                  "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
                  "props": { "label": "Import Strava" },
                  "actions": [
                    { "type": "conditionalNavigate", "if": "state.strava.accessTokenPresent", "to": "strava_import_review", "elseTo": "strava_connect_init", "with": { "athleteId": "{{route.athleteId}}" } }
                  ]
                }
              ]
            }
          ]
        },

        {
          "type": "conditionalRender",
          "id": "tab_cues",
          "condition": "{{state.currentDetailTab === 'cues'}}",
          "components": [
            {
              "type": "card",
              "id": "card_cues",
              "props": { "title": "What Works", "collapsible": false },
              "dataBinding": "mockData.selectedAthlete.cues",
              "components": [
                {
                  "type": "kvList",
                  "id": "cues_list",
                  "props": {
                    "items": [
                      { "k": "Helps", "v": "{{data.helps || 'Not set'}}" },
                      { "k": "Avoid", "v": "{{data.avoids || 'Not set'}}" },
                      { "k": "Best cues", "v": "{{data.bestCues || 'Not set'}}" },
                      { "k": "Kit", "v": "{{data.kit || 'Not set'}}" }
                    ]
                  }
                }
              ],
              "footerActions": [
                {
                  "type": "button",
                  "id": "btn_edit_cues",
                  "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
                  "props": { "label": "Edit cues" },
                  "actions": [{ "type": "navigate", "to": "edit_cues", "with": { "athleteId": "{{route.athleteId}}" } }]
                }
              ]
            }
          ]
        },

        {
          "type": "conditionalRender",
          "id": "tab_settings",
          "condition": "{{state.currentDetailTab === 'settings'}}",
          "components": [
            {
              "type": "sectionTitle",
              "id": "sec_privacy",
              "props": { "text": "Privacy & Consent" }
            },
            {
              "type": "toggle",
              "id": "consent_photos",
              "props": { "label": "Allow photos in timeline", "default": false }
            },
            {
              "type": "toggle",
              "id": "consent_location",
              "props": { "label": "Show route/maps to coaches", "default": false }
            },
            { "type": "divider", "id": "div1" },
            {
              "type": "sectionTitle",
              "id": "sec_strava",
              "props": { "text": "Strava Settings" }
            },
            {
              "type": "text",
              "id": "strava_status",
              "props": { "text": "{{state.strava.accessTokenPresent ? '‚úì Connected to Strava' : 'Not connected'}}" }
            },
            {
              "type": "textInput",
              "id": "strava_hashtag",
              "props": { "label": "Hashtag for auto-sync", "placeholder": "#sosg", "value": "{{state.strava.hashtag}}" },
              "actions": [
                { "type": "setState", "path": "state.strava.hashtag", "value": "{{value}}" }
              ]
            },
            {
              "type": "button",
              "id": "btn_connect_strava",
              "visibility": { "condition": "{{!state.strava.accessTokenPresent}}" },
              "props": { "label": "Connect Strava" },
              "actions": [{ "type": "navigate", "to": "strava_connect_init", "with": { "athleteId": "{{route.athleteId}}" } }]
            }
          ]
        },

        {
          "type": "conditionalRender",
          "id": "modal_add_note",
          "condition": "{{state.uiState.activeModal === 'addNote'}}",
          "components": [
            {
              "type": "modalOverlay",
              "id": "overlay_add_note",
              "props": { "title": "Add Coach Note" },
              "onClose": [{ "type": "setState", "path": "state.uiState.activeModal", "value": null }],
              "components": [
                { "type": "emojiPicker", "id": "modal_mood_before", "props": { "label": "Mood before" } },
                { "type": "emojiPicker", "id": "modal_mood_after", "props": { "label": "Mood after" } },
                { "type": "textArea", "id": "modal_went_well", "props": { "label": "What went well", "maxChars": 120 } },
                { "type": "textArea", "id": "modal_was_hard", "props": { "label": "What was hard", "maxChars": 120 } },
                { "type": "textArea", "id": "modal_next_time", "props": { "label": "Next time: do / avoid", "maxChars": 120 } },
                {
                  "type": "button",
                  "id": "btn_modal_save_note",
                  "props": { "label": "Save Note" },
                  "actions": [
                    { "type": "mutateMock", "target": "mockData.selectedAthlete.timeline", "operation": "prepend", "valueTemplate": "mockTemplates.newNote" },
                    { "type": "setState", "path": "state.uiState.activeModal", "value": null }
                  ]
                }
              ]
            }
          ]
        },

        {
          "type": "conditionalRender",
          "id": "modal_add_session",
          "condition": "{{state.uiState.activeModal === 'addSession'}}",
          "components": [
            {
              "type": "modalOverlay",
              "id": "overlay_add_session",
              "props": { "title": "Add Session" },
              "onClose": [{ "type": "setState", "path": "state.uiState.activeModal", "value": null }],
              "components": [
                { "type": "dateTimePicker", "id": "modal_session_time", "props": { "label": "Date & time" } },
                { "type": "numberInput", "id": "modal_distance_km", "props": { "label": "Distance (km)", "step": 0.1 } },
                { "type": "numberInput", "id": "modal_moving_minutes", "props": { "label": "Moving time (min)", "step": 1 } },
                {
                  "type": "select",
                  "id": "modal_effort",
                  "props": { "label": "Effort", "options": ["Easy", "OK", "Hard"], "default": "OK" }
                },
                {
                  "type": "button",
                  "id": "btn_modal_save_session",
                  "props": { "label": "Save Session" },
                  "actions": [
                    { "type": "mutateMock", "target": "mockData.selectedAthlete.timeline", "operation": "prepend", "valueTemplate": "mockTemplates.newSessionManual" },
                    { "type": "setState", "path": "state.uiState.activeModal", "value": null }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "athlete_timeline",
      "title": "Athlete Timeline",
      "route": "athlete_timeline/:athleteId",
      "layout": { "type": "stack" },
      "onEnter": [
        { "type": "selectAthleteByRouteParam", "param": "athleteId", "from": "mockData.athletesFull", "target": "mockData.selectedAthlete" }
      ],
      "components": [
        {
          "type": "header",
          "id": "hdr_athlete",
          "props": {
            "leftAction": { "type": "navigate", "to": "athlete_list" },
            "titleBinding": "mockData.selectedAthlete.name",
            "rightIcon": "‚öôÔ∏è"
          },
          "actions": [{ "type": "navigate", "to": "athlete_detail", "with": { "athleteId": "{{route.athleteId}}" } }]
        },

        {
          "type": "card",
          "id": "card_cues_pinned",
          "props": { "title": "What works (pinned)", "collapsible": true, "defaultCollapsed": false },
          "dataBinding": "mockData.selectedAthlete.cues",
          "components": [
            { "type": "kvList", "id": "cues_list", "props": { "items": [
              { "k": "Helps", "v": "{{data.helps}}" },
              { "k": "Avoid", "v": "{{data.avoids}}" },
              { "k": "Best cues", "v": "{{data.bestCues}}" },
              { "k": "Kit", "v": "{{data.kit}}" }
            ]}}
          ],
          "footerActions": [
            {
              "type": "button",
              "id": "btn_edit_cues",
              "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
              "props": { "label": "Edit cues" },
              "actions": [{ "type": "navigate", "to": "edit_cues", "with": { "athleteId": "{{route.athleteId}}" } }]
            }
          ]
        },

        { "type": "segmentedControl", "id": "timeline_filter", "props": { "options": ["All", "Sessions", "Notes", "Milestones", "Photos"], "default": "All" } },

        {
          "type": "list",
          "id": "timeline_feed",
          "props": { "itemTemplate": "timelineCard" },
          "dataBinding": "mockData.selectedAthlete.timeline",
          "filterBinding": { "controlId": "timeline_filter", "map": { "All": "*", "Sessions": "session", "Notes": "note", "Milestones": "milestone", "Photos": "photo" } },
          "emptyState": { "title": "No entries yet", "message": "Add a coach note or a first session to start the athlete's journey." }
        },

        {
          "type": "actionBar",
          "id": "timeline_actions",
          "props": { "style": "sticky_bottom" },
          "components": [
            {
              "type": "button",
              "id": "btn_add_note",
              "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
              "props": { "label": "Add Note" },
              "actions": [{ "type": "navigate", "to": "add_coach_note", "with": { "athleteId": "{{route.athleteId}}" } }]
            },
            {
              "type": "button",
              "id": "btn_add_session",
              "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
              "props": { "label": "Add Session" },
              "actions": [{ "type": "navigate", "to": "add_session", "with": { "athleteId": "{{route.athleteId}}" } }]
            },
            {
              "type": "button",
              "id": "btn_import_strava",
              "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
              "props": { "label": "Import Strava" },
              "actions": [
                { "type": "conditionalNavigate", "if": "state.strava.accessTokenPresent", "to": "strava_import_review", "elseTo": "strava_connect_init", "with": { "athleteId": "{{route.athleteId}}" } }
              ]
            }
          ]
        }
      ]
    },

    {
      "id": "add_coach_note",
      "title": "Add Coach Note",
      "route": "add_coach_note/:athleteId",
      "layout": { "type": "form" },
      "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
      "components": [
        { "type": "emojiPicker", "id": "mood_before", "props": { "label": "Mood before" } },
        { "type": "emojiPicker", "id": "mood_after", "props": { "label": "Mood after" } },
        { "type": "textArea", "id": "went_well", "props": { "label": "What went well", "maxChars": 120 } },
        { "type": "textArea", "id": "was_hard", "props": { "label": "What was hard", "maxChars": 120 } },
        { "type": "textArea", "id": "next_time", "props": { "label": "Next time: do / avoid", "maxChars": 120 } },
        {
          "type": "button",
          "id": "btn_save_note",
          "props": { "label": "Save Note" },
          "actions": [
            { "type": "mutateMock", "target": "mockData.selectedAthlete.timeline", "operation": "prepend", "valueTemplate": "mockTemplates.newNote" },
            { "type": "navigate", "to": "athlete_timeline", "with": { "athleteId": "{{route.athleteId}}" } }
          ]
        }
      ]
    },

    {
      "id": "add_session",
      "title": "Add Session",
      "route": "add_session/:athleteId",
      "layout": { "type": "form" },
      "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
      "components": [
        { "type": "dateTimePicker", "id": "session_time", "props": { "label": "Date & time" } },
        { "type": "numberInput", "id": "distance_km", "props": { "label": "Distance (km)", "step": 0.1 } },
        { "type": "numberInput", "id": "moving_minutes", "props": { "label": "Moving time (min)", "step": 1 } },
        { "type": "select", "id": "effort", "props": { "label": "Effort", "options": ["Easy", "OK", "Hard"], "default": "OK" } },
        {
          "type": "button",
          "id": "btn_save_session",
          "props": { "label": "Save Session" },
          "actions": [
            { "type": "mutateMock", "target": "mockData.selectedAthlete.timeline", "operation": "prepend", "valueTemplate": "mockTemplates.newSessionManual" },
            { "type": "navigate", "to": "athlete_timeline", "with": { "athleteId": "{{route.athleteId}}" } }
          ]
        }
      ]
    },

    {
      "id": "athlete_settings",
      "title": "Athlete Settings",
      "route": "athlete_settings/:athleteId",
      "layout": { "type": "stack" },
      "onEnter": [
        { "type": "selectAthleteByRouteParam", "param": "athleteId", "from": "mockData.athletesFull", "target": "mockData.selectedAthlete" }
      ],
      "components": [
        { "type": "sectionTitle", "id": "sec_privacy", "props": { "text": "Privacy & Consent" } },
        { "type": "toggle", "id": "consent_photos", "props": { "label": "Allow photos in timeline", "default": false } },
        { "type": "toggle", "id": "consent_location", "props": { "label": "Show route/maps to coaches", "default": false } },
        { "type": "divider", "id": "div1" },
        { "type": "sectionTitle", "id": "sec_strava", "props": { "text": "Strava" } },
        {
          "type": "button",
          "id": "btn_strava_connect",
          "props": { "label": "Connect Strava" },
          "actions": [{ "type": "navigate", "to": "strava_connect_init", "with": { "athleteId": "{{route.athleteId}}" } }]
        }
      ]
    },

    {
      "id": "strava_connect_init",
      "title": "Connect Strava",
      "route": "strava_connect_init/:athleteId",
      "layout": { "type": "stack" },
      "components": [
        { "type": "div", "props": { "className": "strava-info" }, "components": [
          { "type": "text", "id": "strava_info", "props": { "text": "Connect a Strava account to auto-import runs with your coaching hashtag. In production, this uses OAuth." } }
        ]},
        {
          "type": "button",
          "id": "btn_simulate_strava_connect",
          "props": { "label": "Connect Strava (simulate)" },
          "actions": [
            { "type": "setState", "path": "state.strava.accessTokenPresent", "value": true },
            { "type": "navigate", "to": "athlete_detail", "with": { "athleteId": "{{route.athleteId}}" } }
          ]
        }
      ]
    },

    {
      "id": "strava_import_review",
      "title": "Import from Strava",
      "route": "strava_import_review/:athleteId",
      "layout": { "type": "stack" },
      "components": [
        { "type": "div", "props": { "className": "strava-info" }, "components": [
          { "type": "text", "id": "rules_title", "props": { "text": "Review & import Strava activities" } }
        ]},
        {
          "type": "select",
          "id": "import_mode",
          "props": { "label": "Import mode", "options": ["TAG", "TIME_WINDOW"], "default": "TAG" },
          "actions": [{ "type": "setState", "path": "state.strava.importRules.mode", "value": "{{value}}" }]
        },
        { "type": "textInput", "id": "tag", "props": { "label": "Tag (if MODE=TAG)", "placeholder": "#sosg" } },
        { "type": "numberInput", "id": "time_window", "props": { "label": "Time window (minutes)", "step": 15 } },
        { "type": "divider", "id": "div2" },
        {
          "type": "list",
          "id": "candidate_activities",
          "props": { "itemTemplate": "stravaCandidateCard", "className": "strava-candidates" },
          "dataBinding": "mockData.stravaCandidates"
        },
        {
          "type": "button",
          "id": "btn_import_selected",
          "props": { "label": "Import selected" },
          "actions": [
            { "type": "mutateMock", "target": "mockData.selectedAthlete.timeline", "operation": "prependMany", "valueBinding": "mockData.stravaCandidatesSelectedAsTimelineEvents" },
            { "type": "setState", "path": "state.strava.lastImportAt", "value": "NOW" },
            { "type": "navigate", "to": "athlete_detail", "with": { "athleteId": "{{route.athleteId}}" } }
          ]
        }
      ]
    },

    {
      "id": "edit_cues",
      "title": "Edit What Works",
      "route": "edit_cues/:athleteId",
      "layout": { "type": "form" },
      "visibility": { "roles": ["CAREGIVER", "COACH", "ADMIN"] },
      "components": [
        { "type": "chipInput", "id": "helps", "props": { "label": "Helps (add multiple)" } },
        { "type": "chipInput", "id": "avoids", "props": { "label": "Avoid (add multiple)" } },
        { "type": "chipInput", "id": "bestCues", "props": { "label": "Best cues (add multiple)" } },
        { "type": "chipInput", "id": "kit", "props": { "label": "Kit (add multiple)" } },
        {
          "type": "button",
          "id": "btn_save_cues",
          "props": { "label": "Save" },
          "actions": [
            { "type": "toast", "message": "Cues saved (prototype)." },
            { "type": "navigate", "to": "athlete_detail", "with": { "athleteId": "{{route.athleteId}}" } }
          ]
        }
      ]
    },

    {
      "id": "register",
      "title": "Register",
      "route": "register",
      "layout": { "type": "centered" },
      "components": [
        { "type": "textInput", "id": "email", "props": { "label": "Email", "placeholder": "name@example.com" } },
        { "type": "passwordInput", "id": "password", "props": { "label": "Password" } },
        { "type": "passwordInput", "id": "confirm_password", "props": { "label": "Confirm Password" } },
        {
          "type": "select",
          "id": "role_selector",
          "props": { "label": "Role", "options": ["CAREGIVER", "COACH", "ADMIN"], "default": "CAREGIVER" },
          "actions": [{ "type": "setState", "path": "state.role", "value": "{{value}}" }]
        },
        {
          "type": "button",
          "id": "btn_register",
          "props": { "label": "Register" },
          "actions": [
            { "type": "setState", "path": "state.authed", "value": true },
            { "type": "navigate", "to": "athlete_list" }
          ]
        },
        {
          "type": "link",
          "id": "link_login",
          "props": { "text": "Already have an account? Login" },
          "actions": [{ "type": "navigate", "to": "login" }]
        }
      ]
    },

    {
      "id": "profile",
      "title": "Profile",
      "route": "profile",
      "layout": { "type": "stack" },
      "components": [
        {
          "type": "div",
          "id": "profile_header",
          "props": { "className": "profile-header" },
          "components": [
            { "type": "div", "props": { "className": "profile-avatar" }, "content": "üë§" },
            { "type": "text", "props": { "text": "{{state.role}}" } }
          ]
        },
        {
          "type": "div",
          "id": "profile_info",
          "props": { "className": "profile-info" },
          "components": [
            { "type": "kvList", "id": "user_info", "props": { "items": [
              { "k": "Role", "v": "{{state.role}}" },
              { "k": "Status", "v": "{{state.authed ? 'Authenticated' : 'Guest'}}" }
            ]}}
          ]
        },
        {
          "type": "div",
          "id": "profile_actions",
          "props": { "className": "profile-actions" },
          "components": [
            {
              "type": "button",
              "id": "btn_logout",
              "props": { "label": "Logout" },
              "actions": [
                { "type": "setState", "path": "state.authed", "value": false },
                { "type": "navigate", "to": "login" }
              ]
            }
          ]
        }
      ]
    }
  ],
  "templates": {
    "athleteCard": {
      "type": "div",
      "className": "athlete-row",
      "components": [
        { "type": "div", "props": { "className": "athlete-row-content" }, "components": [
          { "type": "div", "props": { "className": "athlete-name" }, "content": "{{item.name}}" },
          { "type": "div", "props": { "className": "athlete-meta" }, "content": "{{item.lastActivityFormatted}} ‚Ä¢ {{item.sessionCount}} sessions" }
        ]},
        { "type": "div", "props": { "className": "divider" } }
      ]
    },
    "timelineCard": {
      "type": "card",
      "className": "card-feed-item {{item.type }}",
      "title": "{{item.icon}} {{item.title}}",
      "subtitle": "{{item.subtitle}}",
      "body": "{{item.body}}",
      "rightContent": "{{item.date}}",
      "badge": "{{item.source === 'STRAVA' ? 'Auto-synced' : ''}}"
    },
    "stravaCandidateCard": {
      "type": "div",
      "className": "strava-candidate-item",
      "components": [
        { "type": "div", "props": { "className": "strava-candidate-title" }, "content": "üèÉ {{item.name}}" },
        { "type": "div", "props": { "className": "strava-candidate-meta" }, "content": "{{item.distanceKm}} km ‚Ä¢ {{item.movingMin}} min ‚Ä¢ {{item.date}}" }
      ]
    }
  },
  "mockData": {
    "athletes": [
      { "id": "a1", "name": "Daniel", "status": "active", "lastActivity": "2025-02-15", "lastActivityFormatted": "2 days ago", "sessionCount": 5, "latestMilestone": "5 sessions completed", "lastSeen": "2 days ago" },
      { "id": "a2", "name": "Ayesha", "status": "active", "lastActivity": "2025-02-14", "lastActivityFormatted": "3 days ago", "sessionCount": 8, "latestMilestone": "First continuous 1km", "lastSeen": "1 week ago" },
      { "id": "a3", "name": "Marcus", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 12, "latestMilestone": "Milestone: 10 sessions", "lastSeen": "Today" },
      { "id": "a4", "name": "Emma", "status": "active", "lastActivity": "2025-02-16", "lastActivityFormatted": "1 day ago", "sessionCount": 7, "latestMilestone": "Consistency week", "lastSeen": "1 day ago" },
      { "id": "a5", "name": "James", "status": "inactive", "lastActivity": "2025-01-20", "lastActivityFormatted": "28 days ago", "sessionCount": 3, "latestMilestone": "Joined 2 weeks ago", "lastSeen": "28 days ago" },
      { "id": "a6", "name": "Sarah", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 15, "latestMilestone": "Longest streak: 14 days", "lastSeen": "Today" },
      { "id": "a7", "name": "Noah", "status": "inactive", "lastActivity": "2024-12-10", "lastActivityFormatted": "69 days ago", "sessionCount": 2, "latestMilestone": "First run", "lastSeen": "69 days ago" },
      { "id": "a8", "name": "Olivia", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 9, "latestMilestone": "3 KM personal best", "lastSeen": "Today" },
      { "id": "a9", "name": "Liam", "status": "active", "lastActivity": "2025-02-10", "lastActivityFormatted": "7 days ago", "sessionCount": 6, "latestMilestone": "5 sessions", "lastSeen": "7 days ago" },
      { "id": "a10", "name": "Ava", "status": "inactive", "lastActivity": "2025-01-05", "lastActivityFormatted": "43 days ago", "sessionCount": 1, "latestMilestone": "First activity", "lastSeen": "43 days ago" },
      { "id": "a11", "name": "Ethan", "status": "active", "lastActivity": "2025-02-16", "lastActivityFormatted": "1 day ago", "sessionCount": 11, "latestMilestone": "10 sessions", "lastSeen": "1 day ago" },
      { "id": "a12", "name": "Sophia", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 13, "latestMilestone": "2 week streak", "lastSeen": "Today" },
      { "id": "a13", "name": "Alexander", "status": "inactive", "lastActivity": "2025-01-15", "lastActivityFormatted": "33 days ago", "sessionCount": 4, "latestMilestone": "4 sessions", "lastSeen": "33 days ago" },
      { "id": "a14", "name": "Isabella", "status": "active", "lastActivity": "2025-02-13", "lastActivityFormatted": "4 days ago", "sessionCount": 10, "latestMilestone": "Consistency bonus", "lastSeen": "4 days ago" },
      { "id": "a15", "name": "Mason", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 8, "latestMilestone": "8 sessions", "lastSeen": "Today" },
      { "id": "a16", "name": "Mia", "status": "inactive", "lastActivity": "2024-11-20", "lastActivityFormatted": "89 days ago", "sessionCount": 1, "latestMilestone": "Joined", "lastSeen": "89 days ago" },
      { "id": "a17", "name": "Benjamin", "status": "active", "lastActivity": "2025-02-12", "lastActivityFormatted": "5 days ago", "sessionCount": 6, "latestMilestone": "Milestone", "lastSeen": "5 days ago" },
      { "id": "a18", "name": "Charlotte", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 14, "latestMilestone": "14 sessions", "lastSeen": "Today" },
      { "id": "a19", "name": "Lucas", "status": "inactive", "lastActivity": "2025-01-10", "lastActivityFormatted": "38 days ago", "sessionCount": 2, "latestMilestone": "2 sessions", "lastSeen": "38 days ago" },
      { "id": "a20", "name": "Amelia", "status": "active", "lastActivity": "2025-02-16", "lastActivityFormatted": "1 day ago", "sessionCount": 7, "latestMilestone": "7 sessions", "lastSeen": "1 day ago" },
      { "id": "a21", "name": "Michael", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 11, "latestMilestone": "11 sessions", "lastSeen": "Today" },
      { "id": "a22", "name": "Harper", "status": "inactive", "lastActivity": "2025-01-25", "lastActivityFormatted": "23 days ago", "sessionCount": 3, "latestMilestone": "3 sessions", "lastSeen": "23 days ago" },
      { "id": "a23", "name": "William", "status": "active", "lastActivity": "2025-02-14", "lastActivityFormatted": "3 days ago", "sessionCount": 9, "latestMilestone": "9 sessions", "lastSeen": "3 days ago" },
      { "id": "a24", "name": "Evelyn", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 16, "latestMilestone": "16 sessions", "lastSeen": "Today" },
      { "id": "a25", "name": "Henry", "status": "inactive", "lastActivity": "2024-12-01", "lastActivityFormatted": "78 days ago", "sessionCount": 1, "latestMilestone": "Joined", "lastSeen": "78 days ago" },
      { "id": "a26", "name": "Abigail", "status": "active", "lastActivity": "2025-02-15", "lastActivityFormatted": "2 days ago", "sessionCount": 8, "latestMilestone": "8 sessions", "lastSeen": "2 days ago" },
      { "id": "a27", "name": "Jacob", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 10, "latestMilestone": "10 sessions", "lastSeen": "Today" },
      { "id": "a28", "name": "Elizabeth", "status": "inactive", "lastActivity": "2025-02-01", "lastActivityFormatted": "16 days ago", "sessionCount": 2, "latestMilestone": "2 sessions", "lastSeen": "16 days ago" },
      { "id": "a29", "name": "Jackson", "status": "active", "lastActivity": "2025-02-13", "lastActivityFormatted": "4 days ago", "sessionCount": 5, "latestMilestone": "5 sessions", "lastSeen": "4 days ago" },
      { "id": "a30", "name": "Ella", "status": "active", "lastActivity": "2025-02-17", "lastActivityFormatted": "Today", "sessionCount": 12, "latestMilestone": "12 sessions", "lastSeen": "Today" },
      { "id": "a31", "name": "Sebastian", "status": "inactive", "lastActivity": "2025-01-30", "lastActivityFormatted": "18 days ago", "sessionCount": 3, "latestMilestone": "3 sessions", "lastSeen": "18 days ago" },
      { "id": "a32", "name": "Grace", "status": "active", "lastActivity": "2025-02-16", "lastActivityFormatted": "1 day ago", "sessionCount": 9, "latestMilestone": "9 sessions", "lastSeen": "1 day ago" }
    ],
    "filteredAthletes": [],
    "athletesFull": [
      {
        "id": "a1",
        "name": "Daniel",
        "status": "active",
        "sessionCount": 5,
        "lastActivityFormatted": "2 days ago",
        "lastActivity": "2025-02-15",
        "cues": {
          "helps": "Countdown cues, run/walk 2/1, consistent route",
          "avoids": "Sudden loud noises, mid-run route changes",
          "bestCues": "2 more lamp posts, steady breathing",
          "kit": "Water at 15 min, cap"
        },
        "timeline": [
          { "type": "session", "source": "STRAVA", "icon": "üèÉ", "title": "Session", "subtitle": "2.3 km ‚Ä¢ 24 min ‚Ä¢ Effort: OK", "body": "Imported from Strava (tag #sosg).", "date": "Sat 10:10", "id": "t1" },
          { "type": "note", "icon": "üìù", "title": "Coach note", "subtitle": "Mood üòê ‚Üí üòä", "body": "Went well: steady pace. Hard: tired at 20 min. Next: water at 15.", "date": "Sat 10:35", "id": "t2" },
          { "type": "milestone", "icon": "üéâ", "title": "Milestone", "subtitle": "5 sessions completed", "body": "Consistency win ‚Äî keep it going.", "date": "Sat 10:36", "id": "t3" }
        ]
      },
      {
        "id": "a2",
        "name": "Ayesha",
        "status": "active",
        "sessionCount": 8,
        "lastActivityFormatted": "3 days ago",
        "lastActivity": "2025-02-14",
        "cues": { "helps": "Short cues, predictable stops", "avoids": "Crowded paths", "bestCues": "One more minute", "kit": "Water, sunglasses" },
        "timeline": []
      }
    ],
    "selectedAthlete": {
      "id": "a1",
      "name": "Daniel",
      "status": "active",
      "sessionCount": 5,
      "lastActivityFormatted": "2 days ago",
      "cues": { "helps": "", "avoids": "", "bestCues": "", "kit": "" },
      "timeline": []
    },
    "stravaCandidates": [
      { "id": "s101", "name": "Morning Run", "distanceKm": 2.1, "movingMin": 22, "date": "Sun 09:15", "tag": "#sosg" },
      { "id": "s102", "name": "Park Jog", "distanceKm": 3.0, "movingMin": 31, "date": "Wed 18:40", "tag": "" }
    ],
    "stravaCandidatesSelectedAsTimelineEvents": [
      { "type": "session", "source": "STRAVA", "icon": "üèÉ", "title": "Session", "subtitle": "2.1 km ‚Ä¢ 22 min ‚Ä¢ Effort: OK", "body": "Imported from Strava.", "date": "Just now" }
    ]
  },
  "mockTemplates": {
    "newNote": { "type": "note", "icon": "üìù", "title": "Coach note", "subtitle": "Mood üòä ‚Üí üòä", "body": "Went well: (from form). Hard: (from form). Next: (from form).", "date": "Just now", "id": "new-note-{{timestamp}}" },
    "newSessionManual": { "type": "session", "source": "MANUAL", "icon": "üèÉ", "title": "Session", "subtitle": "(from form) km ‚Ä¢ (from form) min ‚Ä¢ Effort: (from form)", "body": "Added manually.", "date": "Just now", "id": "new-session-{{timestamp}}" }
  }
}
